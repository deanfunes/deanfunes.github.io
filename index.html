<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>&fnof; &fnof; &fnof;</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    html, body {
      width: 100%;
      overflow-x: hidden;
    }

    body {
      background: black;
      color: white;
      font-family: monospace, Courier, sans-serif;
      padding: 20px;
    }

    body::before {
      content: "";
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 100 100"><filter id="noise"><feTurbulence type="fractalNoise" baseFrequency="0.8" numOctaves="3" stitchTiles="stitch"/></filter><rect width="100%" height="100%" filter="url(#noise)"/></svg>');
      opacity: 0.1;
      z-index: -1;
      animation: glitch-bg 0.5s infinite alternate;
    }

    @keyframes glitch-bg {
      0% { transform: translateX(0); }
      50% { transform: translateX(1px); }
      100% { transform: translateX(-1px); }
    }

    .glitch-line {
      font-family: monospace, Courier, sans-serif;
      color: #ffffff;
      font-size: clamp(1.5em, 3vw, 2em);
      white-space: pre;
      letter-spacing: 1.2px;
    }

    .header-container {
      display: flex;
      align-items: center;
      gap: 20px;
      flex-wrap: nowrap;
    }

    .header-container img {
      width: 160px;
      height: auto;
      flex-shrink: 0;
    }

    .grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 10px;
      margin-top: 20px;
    }

    .grid .cell {
      width: 100%;
      aspect-ratio: 1 / 1;
      background-color: transparent;
      border: 1px solid #444;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
    }

    .grid .cell img {
      width: 100%;
      height: 100%;
      object-fit: contain;
    }

    audio {
      margin-top: 20px;
      width: 100%;
    }

    .viewer {
      position: fixed;
      top: 0; left: 0;
      width: 100vw;
      height: 100vh;
      background: rgba(0, 0, 0, 0.95);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 999;
    }

    .viewer img {
      max-width: 90vw;
      max-height: 90vh;
    }

    .mensaje {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      background: black;
      color: white;
      font-family: monospace;
      font-size: 1.0em;
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 1000;
      opacity: 0;
      transition: opacity 0.5s ease;
      pointer-events: none;
    }

    @media (max-width: 768px) {
      .header-container {
        flex-direction: row;
        flex-wrap: wrap;
      }

      .grid {
        grid-template-columns: repeat(3, 1fr);
        gap: 4px;
        margin: 0;
      }

      .grid .cell {
        border: none;
      }

      .header-container img {
        width: 100%;
        margin: 0;
      }

      .grid .cell img {
        width: 100%;
        height: 100%;
      }

      body {
        padding: 0;
      }

      .glitch-line {
        font-size: clamp(1em, 3vw, 1.5em);
      }
    }
  </style>
</head>
<body>
  <div class="header-container">
    <img src="Logo glitch.gif" alt="Logo" />
    <p class="glitch-line" data-text="deanƒunes"></p>
  </div>

  <h2 class="glitch-line" data-text="demo ƒ"></h2>

  <audio controls>
    <source src="satiro con tek.ogg" type="audio/ogg" />
    Tu navegador no soporta el audio HTML5.
  </audio>

  <div class="grid">
    <div class="cell"><img src="ilustracion1.png" alt="Ilustración 1" /></div>
    <div class="cell"><img src="ilustracion2.png" alt="Ilustración 2" /></div>
    <div class="cell"><img src="ilustracion3.png" alt="Ilustración 3" /></div>
    <div class="cell"><img src="ilustracion4.png" alt="Ilustración 4" /></div>
    <div class="cell"></div>
    <div class="cell"></div>
    <div class="cell"></div>
    <div class="cell"></div>
    <div class="cell"></div>
  </div>

  <div id="viewer" class="viewer" style="display: none;">
    <img id="viewer-img" src="" alt="Preview" />
  </div>

  <div id="mensaje" class="mensaje"></div>

  <script>
    function fullCharsetDecodeWithMovingSides(element, finalText, duration = 3000, stepTime = 50, sideChars = 4) {
      const charset = `ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%^&*()_+-=[]{}|;:',.<>/?~\`¿¡°¬∞÷≈≠¢€£¥•¶§`;
      const length = finalText.length;
      const revealed = Array(length).fill(false);
      const startTime = Date.now();

      const interval = setInterval(() => {
        const now = Date.now();
        const elapsed = now - startTime;

        let displayText = "";

        for (let i = 0; i < length; i++) {
          if (!revealed[i] && Math.random() < 0.08) {
            revealed[i] = true;
          }

          const char = revealed[i] ? finalText[i] : charset[Math.floor(Math.random() * charset.length)];
          displayText += char;
        }

        const prefix = Array(sideChars).fill(0).map(() => charset[Math.floor(Math.random() * charset.length)]).join("");
        const suffix = Array(sideChars).fill(0).map(() => charset[Math.floor(Math.random() * charset.length)]).join("");

        element.textContent = `${prefix} ${displayText} ${suffix}`;

        if (revealed.every(Boolean) && elapsed >= duration) {
          clearInterval(interval);
          setInterval(() => {
            const dynamicPrefix = Array(sideChars).fill(0).map(() => charset[Math.floor(Math.random() * charset.length)]).join("");
            const dynamicSuffix = Array(sideChars).fill(0).map(() => charset[Math.floor(Math.random() * charset.length)]).join("");
            element.textContent = `${dynamicPrefix} ${finalText} ${dynamicSuffix}`;
          }, stepTime);
        }
      }, stepTime);
    }

    document.addEventListener("DOMContentLoaded", () => {
      document.querySelectorAll(".glitch-line").forEach(el => {
        const text = el.getAttribute("data-text") || "";
        fullCharsetDecodeWithMovingSides(el, text, 6000, 80, 1);
      });

      const viewer = document.getElementById("viewer");
      const viewerImg = document.getElementById("viewer-img");
      const mensaje = document.getElementById("mensaje");

      const mensajes = [
        "me recuerda a algo que nunca pasó. entre lo lógico y lo práctico",
        "deanƒunes hace música",
        "la costra de la herida es dulce",
        "se derrite el hielo en la alfombra",
        "llovió bastante en el hotel",
        "me equivoqué, hay algo que no puedo ver, me persigue",
        "se está hundiendo el puñal mas cerca. pero no podrá cortar la trenza",3
      ];

      let mensajeInterval; // para cancelar el anterior

function mostrarMensajeConAnimacion(texto) {
  if (mensajeInterval) clearInterval(mensajeInterval); // cancelar anterior

  const charset = `ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%^&*()_+-=[]{}|;:',.<>/?~\`¿¡°¬∞÷≈≠¢€£¥•¶§`;
  const finalText = texto;
  const length = finalText.length;
  const revealed = Array(length).fill(false);
  const startTime = Date.now();
  const duration = 3000;
  const stepTime = 30;
  const sideChars = 6;

  mensaje.style.opacity = 1;
  mensaje.style.pointerEvents = "none";

  mensajeInterval = setInterval(() => {
    const now = Date.now();
    const elapsed = now - startTime;

    let displayText = "";

    for (let i = 0; i < length; i++) {
      if (!revealed[i] && Math.random() < 0.08) {
        revealed[i] = true;
      }

      const char = revealed[i]
        ? finalText[i]
        : charset[Math.floor(Math.random() * charset.length)];
      displayText += char;
    }

   const prefix = Array(sideChars).fill(0).map(() => charset[Math.floor(Math.random() * charset.length)]).join("");
const suffix = Array(sideChars).fill(0).map(() => charset[Math.floor(Math.random() * charset.length)]).join("");
mensaje.textContent = `${prefix} ${displayText} ${suffix}`;

    if (revealed.every(Boolean) && elapsed >= duration) {
      clearInterval(mensajeInterval);
      mensajeInterval = null;

      setTimeout(() => {
        mensaje.style.opacity = 0;
        mensaje.textContent = "";
      }, 500);
    }
  }, stepTime);
}

      document.querySelectorAll(".grid .cell img").forEach(img => {
        img.addEventListener("click", () => {
          const random = mensajes[Math.floor(Math.random() * mensajes.length)];
          mostrarMensajeConAnimacion(random);

          setTimeout(() => {
            viewerImg.src = img.src;
            viewer.style.display = "flex";
          }, 3000);
        });
      });

      viewer.addEventListener("click", () => {
        viewer.style.display = "none";
      });

      document.addEventListener("keydown", (e) => {
        if (e.key === "Escape") viewer.style.display = "none";
      });
    });
  </script>
</body>
</html>
